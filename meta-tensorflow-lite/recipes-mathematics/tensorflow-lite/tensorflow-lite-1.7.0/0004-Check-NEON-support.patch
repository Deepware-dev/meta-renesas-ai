From 913eee94745f2fd3993db61c9dc531f5b2932165 Mon Sep 17 00:00:00 2001
From: Jianming Qiao <jianming.qiao@bp.renesas.com>
Date: Wed, 16 May 2018 16:25:24 +0100
Subject: [PATCH 4/5] Check NEON support

Signed-off-by: Jianming Qiao <jianming.qiao@bp.renesas.com>
---
 tensorflow/contrib/lite/examples/label_image/label_image.cc | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

diff --git a/tensorflow/contrib/lite/examples/label_image/label_image.cc b/tensorflow/contrib/lite/examples/label_image/label_image.cc
index a91467d..e9b4627 100644
--- a/tensorflow/contrib/lite/examples/label_image/label_image.cc
+++ b/tensorflow/contrib/lite/examples/label_image/label_image.cc
@@ -39,6 +39,9 @@ limitations under the License.
 #include "tensorflow/contrib/lite/examples/label_image/bitmap_helpers.h"
 #include "tensorflow/contrib/lite/examples/label_image/get_top_n.h"
 
+// check NEON
+#include "tensorflow/contrib/lite/kernels/internal/optimized/cpu_check.h"
+
 #define LOG(x) std::cerr
 
 namespace tflite {
@@ -95,8 +98,6 @@ void RunInference(Settings* s) {
     exit(-1);
   }
 
-  interpreter->UseNNAPI(s->accel);
-
   if (s->verbose) {
     LOG(INFO) << "tensors size: " << interpreter->tensors_size() << "\n";
     LOG(INFO) << "nodes size: " << interpreter->nodes_size() << "\n";
@@ -304,5 +305,10 @@ int Main(int argc, char** argv) {
 }  // namespace tflite
 
 int main(int argc, char** argv) {
+  if(tflite::TestCPUFeatureNeon())
+      std::cout << "Neon Support" << std::endl;
+  else
+      std::cout << "No Neon Support" << std::endl;
+
   return tflite::label_image::Main(argc, argv);
 }
-- 
2.7.4

